.\" Japanese Version Copyright (c) 2000 Kazuyoshi Furutaka and Yuichi SATO
.\"         all rights reserved.
.\" Translated Fri Feb 14 1997
.\"	by Kazuyoshi Furutaka <furutaka@Flux.tokai.jaeri.go.jp>
.\" Updated and Modified Thu Nov  2 18:23:49 JST 2000
.\"	by Yuichi SATO <sato@complex.eng.hokudai.ac.jp>
.\" Updated and Modified Fri May 14 23:47:04 JST 2004
.\"	by Yuichi SATO <ysato444@yahoo.co.jp>
.\"
.TH QUOTAON 8
.UC 4
.SH 名前
quotaon, quotaoff \- ファイルシステムの quota を起動・停止する
.SH 書式
.B /usr/sbin/quotaon
[
.B \-vugfp
] [
.B \-F
.I format-name
]
.IR filesystem .\|.\|.
.br
.B /usr/sbin/quotaon
[
.B \-avugfp
] [
.B \-F
.I format-name
]
.LP
.B /usr/sbin/quotaoff
[
.B \-vugp
]
[
.B \-x
.I state
]
.IR filesystem .\|.\|.
.br
.B /usr/sbin/quotaoff
[
.B \-avugp
]
.SH 説明
.SS quotaon
.IX  "quotaon command"  ""  "\fLquotaon\fP \(em turn filesystem quotas on"
.IX  "user quotas"  "quotaon command"  ""  "\fLquotaon\fP \(em turn filesystem quotas on"
.IX  "disk quotas"  "quotaon command"  ""  "\fLquotaon\fP \(em turn filesystem quotas on"
.IX  "quotas"  "quotaon command"  ""  "\fLquotaon\fP \(em turn filesystem quotas on"
.IX  "filesystem"  "quotaon command"  ""  "\fLquotaon\fP \(em turn filesystem quotas on"
.LP
.B quotaon
は、1 つ以上のファイルシステムについて
ディスク quota を起動するようにシステムに通知する。
ファイルシステムの quota ファイルは、
そのファイルシステムのルートディレクトリに存在しなければならない。
また、ユーザーの quota 用のファイルは
.IR aquota.user
(バージョン 2 のユーザー quota),
.IR quota.user
(バージョン 1 のユーザー quota),
(for version 1 user quota),
.IR aquota.group
(バージョン 2 のグループ quota),
.IR quota.group
(バージョン 1 のグループ quota)
という名前でなければならない。
.PP
XFS ファイルシステムは特殊なケースである -
XFS は quota 情報をファイルシステムメタデータとして扱い、
ジャーナルを用いて高レベルで一貫性を保証する。
XFS ディスク quota システムには、
集計 (accounting) と制限の強制 (limit enforcement) を行う
2 つのコンポーネントがある。
XFS ファイルシステムは quota の集計をマウント時に有効にする必要がある。
quota 集計を有効にした後で、
XFS ファイルシステムの制限の強制を有効にしたり無効にしたりできる。
デフォルトでは集計と強制の両方が有効にされる。
.PP
XFS の quota の実装では、ユーザーから見えるファイルではなく
(ファイルシステムの) 内部に quota 情報を格納する。
.SS quotaoff
.IX  "quotaoff command"  ""  "\fLquotaoff\fP \(em turn filesystem quotas off"
.IX  "user quotas"  "quotaoff command"  ""  "\fLquotaoff\fP \(em turn filesystem quotas off"
.IX  "disk quotas"  "quotaoff command"  ""  "\fLquotaoff\fP \(em turn filesystem quotas off"
.IX  "quotas"  "quotaoff command"  ""  "\fLquotaoff\fP \(em turn filesystem quotas off"
.IX  "filesystem"  "quotaoff command"  ""  "\fLquotaoff\fP \(em turn filesystem quotas off"
.LP
.B quotaoff
は、指定されたファイルシステムについて
全ての quota を停止するようにシステムに通知する。
.SH オプション
.SS quotaon
.TP
.B \-a
.B /etc/fstab
で quota が指定された NFS 以外のファイルシステムのうち、
自動的にマウントされた 
.RB ( noauto
オプションが指定されていない)
全てのファイルシステムについて quota を起動する。
通常はブート時に quota を有効にするために用いられる。
.TP
.B \-v
quota が起動される各ファイルシステム毎にメッセージを表示する。
.TP
.B \-u
ユーザーの quota の操作を行なう。これがデフォルトである。
.TP
.B \-g
グループの quota の操作を行なう。
.TP
.B \-p
quota を有効にするのではなく、
quota の状態 (つまり quota が有効か無効か) の表示だけを行う。
.TP
.B \-f
.B quotaoff
が呼ばれたかのように、
.B quotaon
を動作させる。
.SS quotaoff
.TP
.B \-F \f2format-name\f1
指定されたフォーマットで quota を表示する
(つまり、フォーマットの自動判定を行わない)。
指定可能なフォーマット名は以下の通り:
.B vfsold
(バージョン 1 の quota),
.B vfsv0
(バージョン 2 の quota),
.B xfs
(XFS ファイルシステム上の quota)。
.TP
.B \-a
.B /etc/fstab
にある全てのファイルシステムの quota を停止する。
.TP
.B \-v
quota が停止される各ファイルシステム毎にメッセージを表示する。
.TP
.B \-u
ユーザーの quota の操作を行なう。これがデフォルトである。
.TP
.B \-g
グループの quota の操作を行なう。
.TP
.B \-p
quota を無効にするのではなく、
quota の状態 (つまり quota が有効か無効か) の表示だけを行う。
.TP
.B \-x delete
XFS において、(内部で管理される) quota 情報を保持するために
使用している領域を解放する。
このオプションは XFS にのみ適用可能で、
他のファイルシステムタイプでは黙って無視される。
このオプションは以前に quota を無効にしたファイルシステムにのみ
使用可能である。
.TP
.B \-x enforce
XFS ファイルシステムの制限の強制を無効にする
(quota の集計のみを実行する)。
このオプションは XFS にのみ適用可能で、
他のファイルシステムタイプでは黙って無視される。
.SH "XFS ファイルシステムについての注意"
XFS ファイルシステムの quota を有効にするためには、
.IR mount (8)
または
.B /etc/fstab
の quota オプションを使い、集計と制限の強制の両方を有効にする。
.B quotaon
ユーティリティは、この目的に使うことはできない。
.PP
XFS ルートファイルシステムの quota を有効にするには、
Linux の
.B rootflags
ブートオプションを使って、
ブート時にカーネルに quota のマウントオプションを渡す必要がある。
.PP
XFS ファイルシステムの quota 制限の強制を無効にするには、
.B "repquota -s"
を使って quota の集計と強制がともに有効になっていることを確認せよ。
それから
.B "quotaoff -vo"
を使って制限の強制を無効にすること。
これはファイルシステムがマウントされている間にも実行できる。
.PP
XFS ファイルシステムの quota 制限の強制を有効にするには、
.B "quotaon -v"
を使う。
これはファイルシステムがマウントされている間にも実行できる。
.SH ファイル
.PD 0
.TP 20
.BR aquota.user " または " aquota.group
ファイルシステムのルートに置かれた quota ファイル
(バージョン 2 の quota, XFS 以外のファイルシステム)。
.TP
.BR quota.user " または " quota.group
ファイルシステムのルートに置かれた quota ファイル
(バージョン 1 の quota, XFS 以外のファイルシステム)。
.TP
.B /etc/fstab
デフォルトのファイルシステム。
.PD
.SH 関連項目
.BR quotactl (2),
.BR fstab (5),
.BR repquota (8).
