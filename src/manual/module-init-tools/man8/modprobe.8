.\" This manpage has been automatically generated by docbook2man
.\" from a DocBook document.  This tool can be found at:
.\" <http://shell.ipoline.com/~elmert/comp/docbook2X/>
.\" Please send any bug reports, improvements, comments, patches,
.\" etc. to Steve Cheng <steve@ggi-project.org>.
.\"
.\" Japanese Version Copyright (C) 2005 Suzuki Takashi
.\"         all rights reserved.
.\" Translated Sun Jul 10 00:42:36 JST 2005
.\"         by Suzuki Takashi <JM@linux.or.jp>.
.\"
.TH "MODPROBE" "8" "08 May 2005" "" ""

.SH "名前"
modprobe \- Linux カーネルにモジュールを追加したり削除したりするプログラム
.SH "書式"

\fBmodprobe\fR [ \fB-v\fR ] [ \fB-V\fR ] [ \fB-C \fIconfig-file\fB\fR ] [ \fB-n\fR ] [ \fB-i\fR ] [ \fB-q\fR ] [ \fB-o \fImodulename\fB\fR ] [ \fB\fImodulename\fB\fR ] [ \fB\fImodule parameters\fB\fR\fI ...\fR ]


\fBmodprobe\fR [ \fB-r\fR ] [ \fB-v\fR ] [ \fB-n\fR ] [ \fB-i\fR ] [ \fB\fImodulename\fB\fR\fI ...\fR ]


\fBmodprobe\fR [ \fB-l\fR ] [ \fB-t \fIdirname\fB\fR ] [ \fB\fIwildcard\fB\fR ]


\fBmodprobe\fR [ \fB-c\fR ]
.SH "説明"
.PP
\fBmodprobe\fR は Linux カーネルに賢くモジュールを追加したり削除したりする。
利便性のため、モジュール名において _ と \- の違いはないことに注意。
\fBmodprobe\fR は、
全てのモジュールと他のファイルを
モジュールディレクトリ
\fI/lib/modules/`uname -r`\fR
から参照する。
このほかに、もしあれば
\fI/etc/modprobe.conf\fR 設定ファイルと
\fI/etc/modprobe.d\fR ディレクトリを参照する
(\fBmodprobe.conf\fR(5) を参照) 。
.PP
このバージョンの \fBmodprobe\fR は、
自身ではモジュールに対して何もしないことに注意。
シンボルの解決やパラメータの解釈といった処理はカーネルの中で行なわれる。
そのため、モジュールの不具合はカーネルのメッセージとして報告されることもある。
\fBdmesg\fR(8) を参照。
.PP
\fBmodprobe\fR を実行するときは、
\fBdepmod\fR (\fBdepmod\fR(8) を参照) で生成された
\fImodules.dep\fR が最新の状態になっていなければならない。
このファイルには、
それぞれのモジュールが (もしあれば) 他のどのモジュールを
必要としているかが列挙されていて、
\fBmodprobe\fR はこれを使って依存するモジュールを自動的に追加したり削除したりする。
(\fBmodules.dep\fR(5) を参照) 。
.PP
\fImodulename\fR の後ろに指定された引数は、
カーネルに渡される (設定ファイルに列挙されたオプションに追加される) 。
.SH "オプション"
.TP
\fB-v --verbose \fR
プログラムが何をしているかに関するメッセージを表示する。
通常、 \fBmodprobe\fR は何かまずいことが起こった場合に限って
メッセージを表示する。

このオプションは
\fBinstall\fR および \fBremove\fR コマンドを通じて、
MODPROBE_OPTIONS 環境変数にある \fBmodprobe\fR の他のコマンドに渡される。
.TP
\fB-C --config \fR
このオプションはデフォルトの設定ファイル
(\fI/etc/modprobe.conf\fR や \fI/etc/modprobe.d/\fR)
を無視する。

このオプションは
\fBinstall\fR および \fBremove\fR コマンドを通じて、
MODPROBE_OPTIONS 環境変数にある \fBmodprobe\fR の他のコマンドに渡される。
.TP
\fB-c --showconfig \fR
設定ファイルの内容を表示し、終了する。
.TP
\fB-n --dry-run \fR
このオプションは実際にモジュールを登録したり削除したりする
(あるいは install や remove コマンドを実行する) 以外の、
全ての処理を行なう。
\fB-v\fR と組み合わせて使うと、不具合をデバッグするのに便利である。
.TP
\fB-i --ignore-install --ignore-remove \fR
このオプションを使うと、 \fBmodprobe\fR は
コマンドラインで指定されたモジュールに対する
設定ファイル中の \fBinstall\fR および \fBremove\fR コマンドを
(もしあれば) 無視する
(ただし、依存するモジュールは設定ファイル中のコマンドに従う) 。
\fBmodprobe.conf\fR(5) を参照。
.TP
\fB-q --quiet \fR
通常、 \fBmodprobe\fR は
見つからない (かつエイリアスでもないか
\fBinstall\fR/\fBremove\fR コマンドでもない) モジュールを
削除したり登録したりしようとすると、エラーを通知する。
このフラグを使うと、 \fBmodprobe\fR は
でたらめな名前は単に無視する
(カーネルはこの名前を使って
存在するかもしれないモジュールを日和見的にプローブする) 。
.TP
\fB-r --remove \fR
このオプションで \fBmodprobe\fR は
モジュールを削除する。
このオプションがない場合は登録する。
依存するモジュールも使われていない場合、
\fBmodprobe\fR はそれらも削除しようとする。
登録とは異なり、複数のモジュールをコマンドラインで指定することができる
(モジュールを削除するときにモジュールパラメータを指定するのは意味がない) 。

通常は、モジュールを削除する理由などないが、
不具合のあるモジュールには必要である。
使っているカーネルがモジュールの削除に対応していないかもしれない。
.TP
\fB-V --version \fR
プログラムのバージョンを表示し、終了する。
古いカーネルで実行する場合の注意については下を参照。
.TP
\fB-f --force \fR
モジュールからバージョンに関する情報を取り除こうとする
(そうしないとロードできないモジュールに対して) 。
このオプションは
\fB--force-vermagic\fR と \fB--force-modversion\fR オプションの
両方を使ったのと同じである。
当然のことながら、
これらのチェックはあなたを守るために存在するのであって、
このオプションを使うのは危険である。

このオプションは登録されるすべてのモジュールに適用される。
つまり、
コマンドラインで指定したモジュール (またはエイリアス) だけでなく、
依存するモジュールにも有効である。
.TP
\fB--force-vermagic \fR
どのモジュールにも、
カーネルやコンパイラのバージョンといった、
重要な情報を持つ短い文字列がある。
モジュールがロードに失敗し、カーネルが "version magic" が
一致しないと文句を言う場合、このオプションを使って
"version magic" を削除することができる。
当然のことながら、
これらのチェックはあなたを守るために存在するのであって、
このオプションを使うのは危険である。

このオプションは登録されるすべてのモジュールに適用される。
つまり、
コマンドラインで指定したモジュール (またはエイリアス) だけでなく、
依存するモジュールにも有効である。
.TP
\fB--force-modversion \fR
モジュールが CONFIG_MODVERSIONS をセットして
コンパイルされている場合、
モジュールが使っている (または提供する)
ひとつひとつのインタフェースのバージョンを記したセクションが生成される。
モジュールがロードに失敗し、
カーネルがインタフェースのバージョンの一致しないものがあると文句を言う場合、
"--force-modversion" を使ってバージョン情報をばっさり削除することができる。
当然のことながら、
これらのチェックはあなたを守るために存在するのであって、
このオプションを使うのは危険である。

このオプションは登録されるすべてのモジュールに適用される。
つまり、
コマンドラインで指定したモジュール (またはエイリアス) だけでなく、
依存するモジュールにも有効である。
.TP
\fB-l --list \fR
指定されたワイルドカード
(あるいはワイルドカードが指定されない場合 "*") に一致する
すべてのモジュールを列挙する。
このオプションは下位互換性のために用意されている。
もっと柔軟性のある代替品として、
\fBfind\fR(1) や \fBbasename\fR(1) を参照。
.TP
\fB-a --all \fR
指定されたワイルドカードに一致する全てのモジュールを登録する。
このオプションは下位互換性のために用意されている。
もっと柔軟性のある代替品として、
\fBfind\fR(1) や \fBbasename\fR(1) を参照。
.TP
\fB-t --type \fR
\fB-l\fR を
指定された \fIdirname\fR に一致するディレクトリにあるモジュールに限定する。
このオプションは下位互換性のために用意されている。
もっと柔軟性のある代替品として、
\fBfind\fR(1) や \fBbasename\fR(1) を参照。
.TP
\fB-s --syslog \fR
このオプションを使うと、
すべてのエラーメッセージが syslog の仕組みで
(LOG_NOTICE というレベルの LOG_DAEMON として) 通知されるようになる。
このオプションがない場合は標準エラーに出力される。
このオプションは標準エラーが使えない場合、自動的に有効になる。

このオプションは
\fBinstall\fR および \fBremove\fR コマンドを通じて、
MODPROBE_OPTIONS 環境変数にある \fBmodprobe\fR の他のコマンドに渡される。
.TP
\fB--set-version \fR
カーネルバージョンを設定する。
このオプションがない場合、
カーネルバージョン (モジュールを検索する場所を表す) を
決定するために \fBuname\fR(2) が使われる。
このオプションは下位互換性のチェックも無効にする
(そのため \fBmodprobe.old\fR(8) は一切実行されない) 。
.TP
\fB--show-depends \fR
モジュール (またはエイリアス) の依存関係を列挙する。
モジュール自身も含まれる。
このオプションは
モジュールのファイル名の集合 (空の場合もある) を生成する。
1 行に 1 個のモジュールが表示され、先頭に "insmod" が付く。
install コマンドが適用される場合、先頭に "install" が付く。
install コマンドは一切実行しない。
\fBmodinfo\fR(8) を使えば
モジュール自身からモジュールの依存関係を取り出すことができるが、
エイリアスや install コマンドについては全く分からないことに注意。
.TP
\fB-o --name \fR
このオプションはカーネルに登録されるモジュールの名前を変更しようとする。
テスト用のモジュールには複数回登録することのできるものがあり便利だが、
カーネルは同じ名前のモジュールが 2 個あると拒否する。
通常、モジュールを複数回登録する必要はないはずである。
なぜならモジュールに対応していない場合に役に立たないからである。
.TP
\fB--first-time \fR
通常、 \fBmodprobe\fR は
すでに存在するモジュールを登録しようとした場合や
存在しないモジュールを削除しようとした場合にも
成功する (そして何もしない) 。
この振る舞いは modutils と下位互換性があり、
単純なスクリプトにとっては望ましい。
しかし、もっと複雑なスクリプトでは
\fBmodprobe\fR が実際に何かをしたかどうかを知りたくなることも多い。
このオプションは上のような場合、 modprobe が失敗するようにする。
.SH "下位互換性"
.PP
このバージョンの \fBmodprobe\fP は、
カーネル \fB2.5.48\fP およびそれ以降のためのものである。
古い形式のモジュールに対応したカーネルを検出すると
(そのためのほとんどの処理はユーザ空間で行なわれる) 、
その場で \fBmodprobe.old\fP を実行しようとする。
そのため、ユーザは全く意識しなくてよい。
.SH "環境変数"
.PP
MODPROBE_OPTIONS 環境変数も
\fBmodprobe\fR に引数を渡すのに使うことができる。
.SH "著作権"
.PP
このマニュアルページの著作権表示は Copyright 2002, Rusty Russell, IBM Corporation.
.SH "関連項目"
.PP
\fBmodprobe.conf\fR(5),
\fBlsmod\fR(8),
\fBmodprobe.old\fR(8)
